data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48, 0.27))
ggplot(data1, aes(x=School,y = Regdrives, fill = school)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))
data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48, 0.27))
ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))
movies
knitr::opts_chunk$set(echo = TRUE)
movies = read.csv("http://www.stat.duke.edu/~cr173/Sta323_Sp17/data/movies/movies.csv",
stringsAsFactors = FALSE) %>% tbl_df()
movies
View(movies)
movies = read.csv("http://www.stat.duke.edu/~cr173/Sta323_Sp17/data/movies/movies.csv",
stringsAsFactors = FALSE) %>% tbl_df()
ggplot(data = movies, aes(x = audience_score, y = critics_score, color = genre)) +
geom_point(alpha = 0.5) +
facet_grid(audience_rating ~ title_type)
ggplot(data = movies, aes(x = movies$imdb_num_votes, y = movies$imdb_rating, color = genre)) +
geom_point(alpha = 0.5) +
facet_grid(audience_rating ~ title_type)
ggplot(data = movies, aes(x = movies$imdb_num_votes, y = movies$imdb_rating, color = genre)) + xlab("IDMB number of votes") + ylab("IMDB rating")
ggplot(data = movies, aes(x = movies$imdb_num_votes, y = movies$imdb_rating, color = genre)) + xlab("IDMB number of votes") + ylab("IMDB rating") + geom_point(alpha = 0.5) + facet_grid(audience_rating ~ title_type)
ggplot(data = movies, aes(x = movies$imdb_num_votes, y = movies$imdb_rating, color = genre)) + xlab("IDMB number of votes") + ylab("IMDB rating") + geom_point(alpha = 0.5) + facet_grid(audience_rating ~ mpaa_rating)
ggplot(data = movies, aes(x = movies$imdb_num_votes, y = movies$imdb_rating, color = movies$imdb_num_votes)) + xlab("IDMB number of votes") + ylab("IMDB rating") + geom_point(alpha = 0.5) + facet_grid(audience_rating ~ mpaa_rating)
ggplot(data = movies, aes(x = movies$imdb_num_votes, y = movies$imdb_rating, color = movies$audience_rating)) + xlab("IDMB number of votes") + ylab("IMDB rating") + geom_point(alpha = 0.5) + facet_grid(. ~ mpaa_rating)
ggplot(data = movies, aes(x = movies$imdb_num_votes, y = movies$imdb_rating, color = audience_rating)) + xlab("IDMB number of votes") + ylab("IMDB rating") + geom_point(alpha = 0.5) + facet_grid(. ~ mpaa_rating)
ggplot(data = movies, aes(x = movies$imdb_num_votes, y = movies$imdb_rating, color = audience_rating)) + xlab("IDMB number of votes") + ylab("IMDB rating") + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating)
ggplot(data = movies, aes(x = movies$imdb_num_votes, y = movies$imdb_rating, color = audience_rating)) + labs(x = "IDMB number of votes", y ="IMDB rating", title = "IMDB and RT scores, by MPAA rating") + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating)
ggplot(data = movies, aes(x = movies$audience_score, y = movies$critics_score, color = best_pic_nom)) + labs(x = "audience score", y ="critics score") + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating)
ggplot(data = movies, aes(x = movies$audience_score, y = movies$critics_score, color = best_pic_nom)) + geom_smooth(method = "lm")+ labs(x = "audience score", y ="critics score") + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating)
ggplot(data = movies, aes(x = movies$audience_score, y = movies$critics_score, color = best_pic_nom)) + labs(x = "audience score", y ="critics score") + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating)
ggplot(data = movies, aes(x = movies$audience_score, y = movies$critics_score, color = best_pic_nom)) + labs(x = "audience score", y ="critics score") +  geom_smooth(method='lm') + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating)
ggplot(data = movies, aes(x = movies$audience_score, y = movies$critics_score, color = best_pic_nom)) + labs(x = "audience score", y ="critics score") +  geom_smooth(method='lm', se = FALSE) + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating)
?geom_smooth
ggplot(data = movies, aes(x = movies$audience_score, y = movies$critics_score, color = best_pic_nom)) + labs(x = "audience score", y ="critics score") + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating) + geom_smooth(method='lm', se = FALSE)
ggplot(data = movies, aes(x = movies$audience_score, y = movies$critics_score, color = best_pic_nom)) + labs(x = "audience score", y ="critics score") + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating) + stat_smooth(method='lm', se = FALSE) + stat_smooth(ase(group =1), method = "lm", formula = y ~ x, se =FALSE, colour = "gray" )
ggplot(data = movies, aes(x = movies$audience_score, y = movies$critics_score, color = best_pic_nom)) + labs(x = "audience score", y ="critics score") + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating) + stat_smooth(method='lm', se = FALSE) + stat_smooth(aes(group =1), method = "lm", formula = y ~ x, se =FALSE, colour = "gray" )
ggplot(data = movies, aes(x = movies$audience_score, y = movies$critics_score, color = best_pic_nom)) + labs(x = "audience score", y ="critics score") + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating) + stat_smooth(aes(group =1), method='lm', se = FALSE)
ggplot(data = movies, aes(x = movies$audience_score, y = movies$critics_score, color = best_pic_nom)) + labs(x = "audience score", y ="critics score") + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating) + stat_smooth(aes(group =1), method='lm', se = FALSE, colour = "black")
ggplot(data = movies, aes(x = movies$audience_score, y = movies$critics_score, color = best_pic_nom)) + labs(x = "audience score", y ="critics score") + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating) + stat_smooth(aes(group =1), method='lm', se = FALSE, colour = "black") + geom_abline(slope = 1. colour = "grey")
ggplot(data = movies, aes(x = movies$audience_score, y = movies$critics_score, color = best_pic_nom)) + labs(x = "audience score", y ="critics score") + geom_point(alpha = 0.5) + facet_wrap(~ mpaa_rating) + stat_smooth(aes(group =1), method='lm', se = FALSE, colour = "black") + geom_abline(slope = 1, colour = "grey")
#setwd("~/Dropbox/BassConnectionsRAs/HS Survey/")
library(raster)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(stringr)
library(descr)
library(foreign)
library(haven)
library(knitr)
library(xtable)
#hs = read_csv("1HSPrincipals_012218.csv")
# hs = haven::read_spss("HSPrincipals_01292018.sav")
#hs_labeled= read.csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv", stringsAsFactors = T,na.strings = "")
hs_labeled= read_csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv")
hs=hs_labeled[3:nrow(hs_labeled),]
hs=hs_labeled[-c(1,2),]
hs[hs == "-99"] <- "Ref"
hs$public[hs$public == "Regional"] <- NA
na.omit(hs)
View(hs)
data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48, 0.27))
ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))
data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48%, 0.27%))
data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48, 0.27))
ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) +  scale_y_continuous(labels=scales::percent)
ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.8, 0.2)) + scale_y_continuous(labels=scales::percent)
ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent)
data2 <- data.frame(Regdrives = c("0.48%", "0.27%"))
ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent)
data3 <- data.frame(count = c(73, 7))
ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent) + geom_text(aes(label=data3$count), vjust=-0.3, size=3.5)
ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent) + geom_text(aes(label=data3$count), vjust=-1.0, size=3.5)
data2 <- data.frame(Regdrives = c("0.48% Count(73)", "0.27% Count(7)"))
ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent)
data2 <- data.frame(Regdrives = c("0.48% - Count 73", "0.27% - Count 7"))
hs$stugov_vote[hs$stugov_vote == "Ref"] <- NA
ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent)
#parents engagement
xtable(ct1(hs$public, hs$parents_engaged, xname= 'School', yname= 'Parents Engage', plot = F), caption = "School Type and Engagement of parents", label = "charter school parents were much more engaged ")
ct1(hs$public, hs$parents_engaged, xname= 'School', yname= 'Parents Engage', plot = F)
hs$parents_engaged["Not at all engaged"] <- "Not engaged"
hs$parents_engaged[hs$parents_engaged == "Not at all engaged"] <- "Not engaged"
hs$parents_engaged[hs$parents_engaged == "Not that engaged"] <- "Not engaged"
hs$parents_engaged[hs$parents_engaged == "Somewhat engaged"] <- "Engaged"
hs$parents_engaged[hs$parents_engaged == "Very engaged"] <- "Engaged"
ct1(hs$public, hs$parents_engaged, xname= 'School', yname= 'Parents Engage', plot = F)
data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48, 0.27))
data2 <- data.frame(Regdrives = c("48% - Count 73", "27% - Count 7"))
data3 <- data.frame(count = c(73, 7))
ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent)
data1 <- data.frame(School = c("Public", "Charter"),
Engaged = c(0.68, 0.88))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
ggplot(data1, aes(x=School,y = Engaged, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Engaged Parents") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent)
ggplot(data1, aes(x=School,y = Engaged, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Engaged Parents") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.8, 0.8)) + scale_y_continuous(labels=scales::percent)
ggplot(data1, aes(x=School,y = Engaged, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Engaged Parents") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent)
#setwd("~/Dropbox/BassConnectionsRAs/HS Survey/")
library(raster)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(stringr)
library(descr)
library(foreign)
library(haven)
library(knitr)
library(xtable)
#hs = read_csv("1HSPrincipals_012218.csv")
# hs = haven::read_spss("HSPrincipals_01292018.sav")
#hs_labeled= read.csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv", stringsAsFactors = T,na.strings = "")
hs_labeled= read_csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv")
hs=hs_labeled[3:nrow(hs_labeled),]
hs=hs_labeled[-c(1,2),]
hs[hs == "-99"] <- "Ref"
hs$public[hs$public == "Regional"] <- NA
na.omit(hs)
View(hs)
hs$parents_engaged[hs$parents_engaged == "Not at all engaged"] <- "Not engaged"
hs$parents_engaged[hs$parents_engaged == "Not that engaged"] <- "Not engaged"
hs$parents_engaged[hs$parents_engaged == "Somewhat engaged"] <- "Engaged"
ct2(hs$regdrives, hs$parents_engaged, xname= 'regdrives', yname= 'Parents Engage', plot = F)
ct1(hs$regdrives, hs$parents_engaged, xname= 'regdrives', yname= 'Parents Engage', plot = F)
hs$parents_engaged[hs$parents_engaged == "Very engaged"] <- "Engaged"
ct1(hs$regdrives, hs$parents_engaged, xname= 'regdrives', yname= 'Parents Engage', plot = F)
ct1(hs$public, hs$parents_engaged, xname= 'School', yname= 'Parents Engage', plot = F)
ct1(hs$regdrives, hs$parents_engaged, xname= 'regdrives', yname= 'Parents Engage', plot = F)
data1 <- data.frame(Parents_engaged = c("Engaged", "Not engaged"),
with_regdrives = c(0.73, 0.27))
data2 <- data.frame(Regdrives = c("73% - Count 55", "27% - Count 20"))
ggplot(data1, aes(x=Parents_engaged,y = with_regdrives, fill = Parents_engaged)) +geom_bar(color = "black", stat = "identity") + xlab("Are Parents Engaged") + ylab("Percentage of Regdrives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent)
#setwd("~/Dropbox/BassConnectionsRAs/HS Survey/")
library(raster)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(stringr)
library(descr)
library(foreign)
library(haven)
library(knitr)
library(xtable)
#hs = read_csv("1HSPrincipals_012218.csv")
# hs = haven::read_spss("HSPrincipals_01292018.sav")
#hs_labeled= read.csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv", stringsAsFactors = T,na.strings = "")
hs_labeled= read_csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv")
hs=hs_labeled[3:nrow(hs_labeled),]
hs=hs_labeled[-c(1,2),]
hs[hs == "-99"] <- "Ref"
hs$public[hs$public == "Regional"] <- NA
na.omit(hs)
View(hs)
hs$regdrives[hs$regdrives == "Ref"] <- NA
na.omit(hs$regdrives)
# mydata <- data.frame(hs$public, hs$regdrives)
# p <-ggplot(mydata, aes(hs$public, hs$regdrives))
data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48, 0.27))
data2 <- data.frame(Regdrives = c("48% - Count 73", "27% - Count 7"))
data3 <- data.frame(count = c(73, 7))
ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent)
data1 <- data.frame(Course_num = c(0,1,2,3,4,5),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
ggplot(data1, aes(x=Course_num,y = Count)) +geom_bar(color = "black", stat = "identity") + xlab("Course Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent)
data1 <- data.frame(Course_num = c(0,1,2,3,4,5),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
ggplot(data1, aes(x=Course_num,y = Count)) +geom_bar(color = "black", stat = "identity") + xlab("Course Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9))
data1 <- data.frame(Course_num = c("0","1","2","3","4","5"),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
ggplot(data1, aes(x=Course_num,y = Count)) +geom_bar(color = "black", stat = "identity") + xlab("Course Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9))
data1 <- data.frame(Course_num = c("0","1","2","3","4","5"),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
ggplot(data1, aes(x=Course_num,y = Count)) +geom_bar(color = "black", stat = "identity", colour ="black") + xlab("Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9))
data1 <- data.frame(Course_num = c("0","1","2","3","4","5"),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
ggplot(data1, aes(x=Course_num,y = Count)) +geom_bar(color = "black", stat = "identity", color ="black") + xlab("Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9))
data1 <- data.frame(Course_num = c("0","1","2","3","4","5"),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9))
ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))
ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Courses Provided") + ylab("Number of Schools")
ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))
ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none")
ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("turquoise2", "orangered2", "chartreuse2","gold2"))
ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("turquoise2", "orangered2", "chartreuse2","gold2","turquoise2", "orangered2"))
ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("darkslategray2", "tomato2", "darkolivegreen2","gold2","darkslategray2", "tomato2"))
data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48, 0.27))
data2 <- data.frame(Regdrives = c("48% - Count 73", "27% - Count 7"))
data3 <- data.frame(count = c(73, 7))
ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("darkslategray2", "tomato2"))
data1 <- data.frame(Parents_engaged = c("Engaged", "Not engaged"),
with_regdrives = c(0.73, 0.27))
data2 <- data.frame(Regdrives = c("73% - Count 55", "27% - Count 20"))
ggplot(data1, aes(x=Parents_engaged,y = with_regdrives, fill = Parents_engaged)) +geom_bar(color = "black", stat = "identity") + xlab("Are Parents Engaged") + ylab("Percentage of Regdrives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("darkslategray2", "tomato2"))
ct1(hs$public, hs$parents_engaged, xname= 'School', yname= 'Parents Engage', plot = F)
ggplot(data1, aes(x=Parents_engaged,y = with_regdrives, fill = Parents_engaged)) +geom_bar(color = "black", stat = "identity") + xlab("Are Parents Engaged") + ylab("Percentage of Regdrives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c( "darkolivegreen2","gold2"))
data1 <- data.frame(School = c("Public", "Charter"),
Engaged = c(0.68, 0.88))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
ggplot(data1, aes(x=School,y = Engaged, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Engaged Parents") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("tomato2", "darkolivegreen2"))
data1 <- data.frame(Course_num = c("0","1","2","3","4","5"),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("darkslategray2", "tomato2", "darkolivegreen2","gold2","darkslategray2", "tomato2"))
#setwd("~/Dropbox/BassConnectionsRAs/HS Survey/")
library(raster)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(stringr)
library(descr)
library(foreign)
library(haven)
library(knitr)
library(xtable)
#hs = read_csv("1HSPrincipals_012218.csv")
# hs = haven::read_spss("HSPrincipals_01292018.sav")
#hs_labeled= read.csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv", stringsAsFactors = T,na.strings = "")
hs_labeled= read_csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv")
hs=hs_labeled[3:nrow(hs_labeled),]
hs=hs_labeled[-c(1,2),]
hs[hs == "-99"] <- "Ref"
hs$public[hs$public == "Regional"] <- NA
na.omit(hs)
View(hs)
first_graph <- ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("darkslategray2", "tomato2", "darkolivegreen2","gold2","darkslategray2", "tomato2"))
###graph4
data1 <- data.frame(Course_num = c("0","1","2","3","4","5"),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
first_graph <- ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("darkslategray2", "tomato2", "darkolivegreen2","gold2","darkslategray2", "tomato2"))
ggsave("first_graph.png")
data1 <- data.frame(School = c("Public", "Charter"),
Engaged = c(0.68, 0.88))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
second_graph<- ggplot(data1, aes(x=School,y = Engaged, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Engaged Parents") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("tomato2", "darkolivegreen2"))
ggsave("second_graph.png")
data1 <- data.frame(Parents_engaged = c("Engaged", "Not engaged"),
with_regdrives = c(0.73, 0.27))
data2 <- data.frame(Regdrives = c("73% - Count 55", "27% - Count 20"))
third_graph <- ggplot(data1, aes(x=Parents_engaged,y = with_regdrives, fill = Parents_engaged)) +geom_bar(color = "black", stat = "identity") + xlab("Are Parents Engaged") + ylab("Percentage of Regdrives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c( "darkolivegreen2","gold2"))
ct1(hs$public, hs$parents_engaged, xname= 'School', yname= 'Parents Engage', plot = F)
ggsave("third_graph.png")
data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48, 0.27))
data2 <- data.frame(Regdrives = c("48% - Count 73", "27% - Count 7"))
data3 <- data.frame(count = c(73, 7))
fourth_graph <- ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("darkslategray2", "tomato2"))
ggsave("fourth_graph.png")
data2 <- data.frame(hs$public, s)
data3 <- na.omit(data2)
p <- ggplot(data3, aes(hs.public, s, fill=hs.public)) + geom_boxplot(outlier.colour = "black") + xlab("School Type") + ylab("Student government voting percentage") + stat_summary(fun.y = "mean", geom = "point", shape = 4, size = 2)
p
p <- ggplot(data3, aes(hs.public, s, fill=hs.public)) + geom_boxplot(outlier.colour = "black") + xlab("School Type") + ylab("Student government voting percentage") + stat_summary(fun.y = "mean", geom = "point", shape = 4, size = 2)
ggsave("p.png")
data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48, 0.27))
data2 <- data.frame(Regdrives = c("48% - Count 73", "27% - Count 7"))
data3 <- data.frame(count = c(73, 7))
fourth_graph <- ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("darkslategray2", "tomato2"))
ggsave("fourth_graph.png")
data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48, 0.27))
data2 <- data.frame(Regdrives = c("48% - Count 73", "27% - Count 7"))
data3 <- data.frame(count = c(73, 7))
fourth_graph <- ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("darkslategray2", "darkolivegreen2"))
ggsave("fourth_graph.png")
data2 <- data.frame(hs$public, s)
data3 <- na.omit(data2)
box_plot <- ggplot(data3, aes(hs.public, s, fill=hs.public)) + geom_boxplot(outlier.colour = "black") + xlab("School Type") + ylab("Student government voting percentage") + stat_summary(fun.y = "mean", geom = "point", shape = 4, size = 2)
ggsave("box_plot.png")
data1 <- data.frame(Parents_engaged = c("Engaged", "Not engaged"),
with_regdrives = c(0.73, 0.27))
data2 <- data.frame(Regdrives = c("73% - Count 55", "27% - Count 20"))
third_graph <- ggplot(data1, aes(x=Parents_engaged,y = with_regdrives, fill = Parents_engaged)) +geom_bar(color = "black", stat = "identity") + xlab("Are Parents Engaged") + ylab("Percentage of Regdrives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c( "darkolivegreen2","darkslategray2"))
ct1(hs$public, hs$parents_engaged, xname= 'School', yname= 'Parents Engage', plot = F)
ggsave("third_graph.png")
data1 <- data.frame(School = c("Public", "Charter"),
Engaged = c(0.68, 0.88))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
second_graph<- ggplot(data1, aes(x=School,y = Engaged, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Engaged Parents") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("darkslategray2", "darkolivegreen2"))
ggsave("second_graph.png")
data1 <- data.frame(Course_num = c("0","1","2","3","4","5"),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
first_graph <- ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("darkslategray2", "darkolivegreen2", "darkslategray2","darkolivegreen2","darkslategray2", "darkolivegreen2"))
ggsave("first_graph.png")
hs$stugov_vote[hs$stugov_vote == "Ref"] <- NA
s <- as.numeric(hs$stugov_vote)
# hs$public <- as.factor(hs$public)
# hs$stugov_vote <- as.factor(hs$stugov_vote)
data2 <- data.frame(hs$public, s)
data3 <- na.omit(data2)
box_plot <- ggplot(data3, aes(hs.public, s)) + geom_boxplot(outlier.colour = "black") + xlab("School Type") + ylab("Student government voting percentage") + stat_summary(fun.y = "mean", geom = "point", shape = 4, size = 2) + scale_fill_manual(values=c("darkslategray2", "darkolivegreen2"))
ggsave("box_plot.png")
data2 <- data.frame(hs$public, s)
data3 <- na.omit(data2)
box_plot <- ggplot(data3, aes(hs.public, s)) + geom_boxplot(outlier.colour = "black") + + scale_fill_manual(values=c("darkslategray2", "darkolivegreen2"))+ xlab("School Type") + ylab("Student government voting percentage") + stat_summary(fun.y = "mean", geom = "point", shape = 4, size = 2) + ggtitle("School Type and Student Government Voting Percentage")
box_plot <- ggplot(data3, aes(hs.public, s)) + geom_boxplot(outlier.colour = "black") +  scale_fill_manual(values=c("darkslategray2", "darkolivegreen2"))+ xlab("School Type") + ylab("Student government voting percentage") + stat_summary(fun.y = "mean", geom = "point", shape = 4, size = 2) + ggtitle("School Type and Student Government Voting Percentage")
data2 <- data.frame(hs$public, s)
data3 <- na.omit(data2)
box_plot <- ggplot(data3, aes(hs.public, s)) + geom_boxplot(outlier.colour = "black") +  scale_fill_manual(values=c("darkslategray2", "darkolivegreen2"))+ xlab("School Type") + ylab("Student government voting percentage") + stat_summary(fun.y = "mean", geom = "point", shape = 4, size = 2) + ggtitle("School Type and Student Government Voting Percentage")
ggsave("box_plot.png")
data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48, 0.27))
data2 <- data.frame(Regdrives = c("48% - Count 73", "27% - Count 7"))
data3 <- data.frame(count = c(73, 7))
fourth_graph <- ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("darkslategray2", "darkolivegreen2")) + ggtitle("School Type and Registration Drives")
ggsave("fourth_graph.png")
data1 <- data.frame(School = c("Public", "Charter"),
Engaged = c(0.68, 0.88))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
second_graph<- ggplot(data1, aes(x=School,y = Engaged, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Engaged Parents") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("darkslategray2", "darkolivegreen2")) + ggtitle("School Type and Parents Engagement")
ggsave("second_graph.png")
data1 <- data.frame(Course_num = c("0","1","2","3","4","5"),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
first_graph <- ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Civic Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("darkslategray2", "darkolivegreen2", "darkslategray2","darkolivegreen2","darkslategray2", "darkolivegreen2")) + ggtitle("Provided Civic Courses and Schools count")
ggsave("first_graph.png")
box_plot <- ggplot(data3, aes(hs.public, s)) + geom_boxplot(outlier.colour = "black") +  scale_fill_manual(values=c("darkslategray2", "darkolivegreen2"))+ xlab("School Type") + ylab("Student government voting percentage") + stat_summary(fun.y = "mean", geom = "point", shape = 4, size = 2) + ggtitle("School Type and Student Government Voting Percentage")
ggsave("box_plot.png")
hs$stugov_vote[hs$stugov_vote == "Ref"] <- NA
s <- as.numeric(hs$stugov_vote)
data2 <- data.frame(hs$public, s)
data3 <- na.omit(data2)
plot <- ggplot(data3, aes(hs.public, s)) + geom_boxplot(outlier.colour = "black") +  scale_fill_manual(values=c("darkslategray2", "darkolivegreen2"))+ xlab("School Type") + ylab("Student government voting percentage") + stat_summary(fun.y = "mean", geom = "point", shape = 4, size = 2) + ggtitle("School Type and Student Government Voting Percentage")
ggsave("plot.png")
plot <- ggplot(data3, aes(hs.public, s)) + geom_boxplot(outlier.colour = "black") +  scale_fill_manual(values=c("darkslategray2", "darkolivegreen2"))+ xlab("School Type") + ylab("Student government voting percentage") + stat_summary(fun.y = "mean", geom = "point", shape = 4, size = 2) + ggtitle("School Type and Student Government Voting Percentage")
plot <- ggplot(data3, aes(hs.public, s, fill = hs.public)) + geom_boxplot(outlier.colour = "black") +  scale_fill_manual(values=c("darkslategray2", "darkolivegreen2"))+ xlab("School Type") + ylab("Student government voting percentage") + stat_summary(fun.y = "mean", geom = "point", shape = 4, size = 2) + ggtitle("School Type and Student Government Voting Percentage")
ggsave("plot.png")
#setwd("~/Dropbox/BassConnectionsRAs/HS Survey/")
library(raster)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(stringr)
library(descr)
library(foreign)
library(haven)
library(knitr)
library(xtable)
#hs = read_csv("1HSPrincipals_012218.csv")
# hs = haven::read_spss("HSPrincipals_01292018.sav")
#hs_labeled= read.csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv", stringsAsFactors = T,na.strings = "")
hs_labeled= read_csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv")
hs=hs_labeled[3:nrow(hs_labeled),]
hs=hs_labeled[-c(1,2),]
hs[hs == "-99"] <- "Ref"
hs$public[hs$public == "Regional"] <- NA
na.omit(hs)
View(hs)
data1 <- data.frame(School = c("Public", "Charter"),
Engaged = c(0.68, 0.88))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
second_graph<- ggplot(data1, aes(x=School,y = Engaged, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Engaged Parents") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("blue3", "darkolivegreen2")) + ggtitle("School Type and Parents Engagement")
ggsave("second_graph.png")
data1 <- data.frame(School = c("Public", "Charter"),
Engaged = c(0.68, 0.88))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
second_graph<- ggplot(data1, aes(x=School,y = Engaged, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Engaged Parents") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("blue1", "darkolivegreen2")) + ggtitle("School Type and Parents Engagement")
ggsave("second_graph.png")
data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48, 0.27))
data2 <- data.frame(Regdrives = c("48% - Count 73", "27% - Count 7"))
data3 <- data.frame(count = c(73, 7))
fourth_graph <- ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("blue1", "darkolivegreen2")) + ggtitle("School Type and Registration Drives")
ggsave("fourth_graph.png")
hs$stugov_vote[hs$stugov_vote == "Ref"] <- NA
s <- as.numeric(hs$stugov_vote)
data2 <- data.frame(hs$public, s)
data3 <- na.omit(data2)
plot <- ggplot(data3, aes(hs.public, s, fill = hs.public)) + geom_boxplot(outlier.colour = "black") +  scale_fill_manual(values=c("blue1", "darkolivegreen2"))+ xlab("School Type") + ylab("Student government voting percentage") + stat_summary(fun.y = "mean", geom = "point", shape = 4, size = 2) + ggtitle("School Type and Student Government Voting Percentage")
ggsave("plot.png")
###graph3
data1 <- data.frame(School = c("Public", "Charter"),
Engaged = c(0.68, 0.88))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
second_graph<- ggplot(data1, aes(x=School,y = Engaged, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Engaged Parents") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("blue1", "darkolivegreen2")) + ggtitle("School Type and Parents Engagement")
ggsave("second_graph.png")
###graph4
data1 <- data.frame(Course_num = c("0","1","2","3","4","5"),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
first_graph <- ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Civic Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("blue1", "darkolivegreen2", "blue1","darkolivegreen2","blue1", "darkolivegreen2")) + ggtitle("Provided Civic Courses and Schools count")
ggsave("first_graph.png")
#setwd("~/Dropbox/BassConnectionsRAs/HS Survey/")
library(raster)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(stringr)
library(descr)
library(foreign)
library(haven)
library(knitr)
library(xtable)
#hs = read_csv("1HSPrincipals_012218.csv")
# hs = haven::read_spss("HSPrincipals_01292018.sav")
#hs_labeled= read.csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv", stringsAsFactors = T,na.strings = "")
hs_labeled= read_csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv")
hs=hs_labeled[3:nrow(hs_labeled),]
hs=hs_labeled[-c(1,2),]
hs[hs == "-99"] <- "Ref"
hs$public[hs$public == "Regional"] <- NA
na.omit(hs)
View(hs)
data1 <- data.frame(School = c("Public", "Charter"),
Regdrives = c(0.48, 0.27))
data2 <- data.frame(Regdrives = c("48% - Count 73", "27% - Count 7"))
data3 <- data.frame(count = c(73, 7))
fourth_graph <- ggplot(data1, aes(x=School,y = Regdrives, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Registration Drives") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.2, 0.8)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("blue1", "darkolivegreen2"))
ggsave("fourth_graph.png")
hs$stugov_vote[hs$stugov_vote == "Ref"] <- NA
s <- as.numeric(hs$stugov_vote)
data2 <- data.frame(hs$public, s)
data3 <- na.omit(data2)
plot <- ggplot(data3, aes(hs.public, s, fill = hs.public)) + geom_boxplot(outlier.colour = "black") +  scale_fill_manual(values=c("blue1", "darkolivegreen2"))+ xlab("School Type") + ylab("Student government voting percentage") + stat_summary(fun.y = "mean", geom = "point", shape = 4, size = 2)
ggsave("plot.png")
data1 <- data.frame(School = c("Public", "Charter"),
Engaged = c(0.68, 0.88))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
second_graph<- ggplot(data1, aes(x=School,y = Engaged, fill = School)) +geom_bar(color = "black", stat = "identity") + xlab("School Type") + ylab("Percentage of Engaged Parents") +geom_text(aes(label=data2$Regdrives), vjust=-0.3, size=3.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12)) + theme(legend.position = c(0.9, 0.9)) + scale_y_continuous(labels=scales::percent) + scale_fill_manual(values=c("blue1", "darkolivegreen2"))
ggsave("second_graph.png")
data1 <- data.frame(Course_num = c("0","1","2","3","4","5"),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
first_graph <- ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Civic Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("blue1", "darkolivegreen2", "blue1","darkolivegreen2","blue1", "darkolivegreen2"))
ggsave("first_graph.png")
#setwd("~/Dropbox/BassConnectionsRAs/HS Survey/")
library(raster)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(stringr)
library(descr)
library(foreign)
library(haven)
library(knitr)
library(xtable)
#hs = read_csv("1HSPrincipals_012218.csv")
# hs = haven::read_spss("HSPrincipals_01292018.sav")
#hs_labeled= read.csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv", stringsAsFactors = T,na.strings = "")
hs_labeled= read_csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv")
hs=hs_labeled[3:nrow(hs_labeled),]
hs=hs_labeled[-c(1,2),]
hs[hs == "-99"] <- "Ref"
hs$public[hs$public == "Regional"] <- NA
na.omit(hs)
View(hs)
data1 <- data.frame(Course_num = c("0","1","2","3","4","5"),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("68% - Count 99", "88% - Count 22"))
first_graph <- ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Civic Courses Provided") + ylab("Number of Schools") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("blue1", "darkolivegreen2", "darkolivegreen2","darkolivegreen2","darkolivegreen2", "darkolivegreen2"))
ggsave("first_graph.png")
#setwd("~/Dropbox/BassConnectionsRAs/HS Survey/")
library(raster)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(stringr)
library(descr)
library(foreign)
library(haven)
library(knitr)
library(xtable)
#hs = read_csv("1HSPrincipals_012218.csv")
# hs = haven::read_spss("HSPrincipals_01292018.sav")
#hs_labeled= read.csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv", stringsAsFactors = T,na.strings = "")
hs_labeled= read_csv("High+School+Civic+Indicators+-+Principals_February+24%2C+2018_14.45.csv")
hs=hs_labeled[3:nrow(hs_labeled),]
hs=hs_labeled[-c(1,2),]
hs[hs == "-99"] <- "Ref"
hs$public[hs$public == "Regional"] <- NA
na.omit(hs)
View(hs)
data1 <- data.frame(Course_num = c("0","1","2","3","4","5"),
Count = c(123, 28,30,18,7,5))
data2 <- data.frame(Regdrives = c("58%", "13%", "14%", "9%", "3%", "2%"))
first_graph <- ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Civic Courses Provided") + ylab("Number of Schools") +geom_text(aes(label=data2$Regdrives) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("blue1", "darkolivegreen2", "darkolivegreen2","darkolivegreen2","darkolivegreen2", "darkolivegreen2"))
ggsave("first_graph.png")
first_graph <- ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Civic Courses Provided") + ylab("Number of Schools") +geom_text(aes(label=data2$Regdrives)) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("blue1", "darkolivegreen2", "darkolivegreen2","darkolivegreen2","darkolivegreen2", "darkolivegreen2"))
ggsave("first_graph.png")
first_graph <- ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Civic Courses Provided") + ylab("Number of Schools") +geom_text(aes(label=data2$Regdrives), position = "dodge") +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("blue1", "darkolivegreen2", "darkolivegreen2","darkolivegreen2","darkolivegreen2", "darkolivegreen2"))
ggsave("first_graph.png")
first_graph
first_graph <- ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Civic Courses Provided") + ylab("Number of Schools") +geom_text(aes(label=data2$Regdrives), nudge_y = 0.5) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("blue1", "darkolivegreen2", "darkolivegreen2","darkolivegreen2","darkolivegreen2", "darkolivegreen2"))
first_graph
first_graph <- ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Civic Courses Provided") + ylab("Number of Schools") +geom_text(aes(label=data2$Regdrives), nudge_y = 2) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("blue1", "darkolivegreen2", "darkolivegreen2","darkolivegreen2","darkolivegreen2", "darkolivegreen2"))
first_graph
first_graph <- ggplot(data1, aes(x=Course_num,y = Count, fill = Course_num)) +geom_bar(color = "black", stat = "identity") + xlab("Number of Civic Courses Provided") + ylab("Number of Schools") +geom_text(aes(label=data2$Regdrives), nudge_y = 3) +theme(axis.text=element_text(size=12), axis.title=element_text(size=12))+ theme(legend.position = "none") + scale_fill_manual(values=c("blue1", "darkolivegreen2", "darkolivegreen2","darkolivegreen2","darkolivegreen2", "darkolivegreen2"))
first_graph
ggsave("first_graph.png")
